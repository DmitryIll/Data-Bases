# Домашнее задание к занятию «Базы данных»

---
### Легенда

Заказчик передал вам [файл в формате Excel](https://github.com/netology-code/sdb-homeworks/blob/main/resources/hw-12-1.xlsx), в котором сформирован отчёт. 

На основе этого отчёта нужно выполнить следующие задания.

### Задание 1

Опишите не менее семи таблиц, из которых состоит база данных:

- какие данные хранятся в этих таблицах;
- какой тип данных у столбцов в этих таблицах, если данные хранятся в PostgreSQL.

Приведите решение к следующему виду:

Сотрудники (

- идентификатор, первичный ключ, serial,
- фамилия varchar(50),
- ...
- идентификатор структурного подразделения, внешний ключ, integer).

#### Решение

В отчете есть столбцы (исходные данные):

```
ФИО сотрудника
Оклад
Должность
Тип подразделения
Структурное подразделение
Дата найма
Адрес филиала
Проект на который назначен
```


##### Нормализация по 1 форме

* Ищем где есть списки в одной ячейке и множественные значения:

- ФИО сотрудника - разделить на три поля Ф.И.О.
- Адрес филиала - разделить на отдельные поля (Край / область), (город), (ул.), (дом). 

#### Нормализация по 2 форме

* убираем повторения выносим в отдельные справочники:
- есть повторения в должностях - должности в отдельный справочник
- тип подразделения
- структурное подразделение
- адрес филиала - будет отдельная таблица со внешними ключами, которые будут ссылаться на справочники Край/Область, Город, Ул., дом. (справочник для Дом можно и не делать, а прям в поле номер дома сразу указывать)
- проект

#### Нормализация по 3 форме
В каждой таблице оставляем только то, что зависит от первичного ключа.

Считаю не хватает в задании информации: не понятно с чем функционально связан адрес филиала? могут быть варианты:
- С сотрудником (с должностью) - где оформлен
- С подразделением - где подразделение "прописано" 
- с проектом - где проект идет
нет информации, но, судя по данным в таблице буду считать что адрес филиала - связан с сотрудником (должностью) - где сотрдуник оформлен. 

Так же не ясно с чем связан проект? С сотрудником, или может с подразделением? Считаю что с сотрудником - сотрудника наняли на проект.

Предлагаю в отдельную таблицу вынести ФИО сотрудника и может доп информацию по сотруднику (например паспортные данные), т.к.:

Вообще в теории у одного сотрудника может быть несколько ставок и должностей, поэтому считаю лучше вынести должности в отдельну таблицу.
Соответственно и оклада может быть тогда два есди две должности.
Плюс сотрудник может уволиться со старой должности и устроиться заново на новую должность. Т.е. лучше ФИО отвязать от долности в отдельную таблицу. Т.е. ФИО при уволенении не удалять - сохранять.
Дата найма, считаю, привязана к договору, т.е. к должности на которую берут (оформляют) сотрудника.

#### Нормализация по высшим формам

- можно еще "сжать" информацию - повторящиеся фамилии, имена тоже вынести в отдельные типа справочники.


Итого пределагаю таблицы:

1. Справочник Фамилий (
    - id, первичный ключ, integer
    - name - Фамилия, varchar(50)
)

2. Справочник имен (
    - id, первичный ключ, integer
    - name - Имя, varchar(50)
)

3. Справочник Отчеств (
    - id, первичный ключ, integer
    - name - Отчество, varchar(50)
)

4. Справочник должностей (
    - id, первичный ключ, integer
    - name - должность, varchar(50)
)

5. Справочник тип подразделения (
    - id, первичный ключ, integer
    - name - тип подразделения, varchar(50)
)

6. Справочник структурное подразделение (
    - id, первичный ключ, integer
    - name - структурное подразделение, varchar(50)
)

7. Справочник краев/областей (
    - id, первичный ключ, integer
    - name - Край или область, varchar(50)
)

8. Справочник Городов (
    - id, первичный ключ, integer
    - name - город, varchar(50)
)

9. Справочник Ул. (
    - id, первичный ключ, bigint
    - name - улица, varchar(50)
)

для номеров домов нет смысла делать отедльный справочник - не сэкономим места в БД. Номер дома будем указывать сразу в таблице.

10. Справочник проектов (
    - id, первичный ключ, integer
    - name - проект, varchar(50)
)

11. Таблица ФИО сотрудников (
    - id, первичный ключ, integer
    - Фамилия, внешний ключ к справочнику фамилий, integer
    - Имя, внешний ключ к справочнику имен, integer
    - Отчество, внешний ключ к справочнику отчеств, integer
)
сюда же можно будет если потребуется добавить дату рождения и др. информацию по сотруднику.

12. Таблица Подразделений (
    - id, первичный ключ, integer
    - подразделение_id , внешний ключ к справочнику подразделений, integer
    - тип_id - тип подразделения, внешний ключ на справочник типа подразделения, integer
)

13. Таблица адресов филиалов (
    - id , первичный ключ, integer
    - Край_id - Внешний ключ - к справочнику крев, integer
    - Город_id - внешний ключ - к справочник городов, integer
    - ул_id -   внешний ключ - к справочнику улиц, bigint
    - дом - номер дома, varchar(10)
)
т.к. в номерах домов могут быть корпуск дроби, то, в символьном типе.

14. Таблица Должности сотрудинков (
    - id, первичный ключ, integer
    - фамилия_id - ссылка на id - таблица ФИО сотрудника, внешний ключ, integer
    - Должность_id - ссылка на должность из справочника, внешний ключ, integer
    - Подразделение_id - ссылка на справочник должностей, внешний ключ, integer
    - дата найма, date
    - адрес_филиала_id - внешний ключ к таблице адресов филиалов, integer
    - проект_id - ссылка внешний ключ к справочнику проектов, integer
)


Оклад я предлагаю вынести в отдельну таблицу, т.к. оклад - это другой тип информации для бухгалтерии, и часто это секретная информация, поэтому на таблицу с окладом моежт иметь смысл дать отдельные права. Такую таблицу можно в отдельном месте хранить на диске и шифровать эти данные на диске. Шифровать можно или средствами СУБД (если есть такой функционал), или можно средствами ОС на диске или в папке сделать шифрование.

15. Таблица окладов (
    - id
    - сотрудник_id - ссылка на id таблицы должностей сотрудников, внешний ключ к таблице должностей сотрудников, integer
    - оклад значение - рубли, money.
)



## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.


### Задание 2*

Перечислите, какие, на ваш взгляд, в этой денормализованной таблице встречаются функциональные зависимости и какие правила вывода нужно применить, чтобы нормализовать данные.
Уже все описал в задании 1 выше.
